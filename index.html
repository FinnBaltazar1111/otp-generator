<title>One-Time Password Generator</title><iframe width=100% height=100% id='output' frameborder></iframe><script src='data:text/javascript;base64,Y2xhc3MgVHdvRkEgewogICAgc3RhdGljIGFzeW5jIGdlbihzZWNyZXQpIHsKICAgICAgICBzZWNyZXQgPSBUd29GQS5kZWNvZGUoIHNlY3JldCApOwoKICAgICAgICBsZXQgdGltZSA9IDMwOwogICAgICAgIGxldCBfdCA9IERhdGUubm93KCk7CgogICAgICAgIGxldCBjb3VudGVyID0gTWF0aC5mbG9vcigoX3QgLyAxMDAwKSAvIHRpbWUpOwoKICAgICAgICBsZXQgYiA9IFR3b0ZBLmludFRvQnl0ZXMoY291bnRlcik7CgogICAgICAgIGxldCBkaWdlc3QgPSBhd2FpdCBUd29GQS5obWFjU0hBMShzZWNyZXQsIGIpOwoKICAgICAgICBsZXQgaCA9IFR3b0ZBLmhleFRvQnl0ZXMoZGlnZXN0KTsKCiAgICAgICAgbGV0IG9mZnNldCA9IGhbMTldICYgMHhmOwogICAgICAgIGxldCB2ID0gKGhbb2Zmc2V0XSAmIDB4N2YpIDw8IDI0IHwKICAgICAgICAgICAgKGhbb2Zmc2V0ICsgMV0gJiAweGZmKSA8PCAxNiB8CiAgICAgICAgICAgIChoW29mZnNldCArIDJdICYgMHhmZikgPDwgOCAgfAogICAgICAgICAgICAoaFtvZmZzZXQgKyAzXSAmIDB4ZmYpOwoKICAgICAgICB2ID0gKHYgJSAxMDAwMDAwKSArICcnOwoKICAgICAgICByZXR1cm4gbmV3IEFycmF5KDctdi5sZW5ndGgpLmpvaW4oJzAnKSArIHY7CiAgICB9CgogICAgc3RhdGljIGhleFRvQnl0ZXMoaGV4KSB7CiAgICAgICAgbGV0IGJ5dGVzID0gW107CiAgICAKICAgICAgICBmb3IobGV0IGMgPSAwLCBDID0gaGV4Lmxlbmd0aDsgYyA8IEM7IGMgKz0gMikgewogICAgICAgICAgICBieXRlcy5wdXNoKHBhcnNlSW50KGhleC5zdWJzdHIoYywgMiksIDE2KSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheShieXRlcyk7CiAgICB9CgogICAgc3RhdGljIGludFRvQnl0ZXMobnVtKSB7CiAgICAgICAgbGV0IGJ5dGVzID0gW107CgogICAgICAgIGZvcih2YXIgaT03IDsgaT49MCA7IC0taSkgewogICAgICAgICAgICBieXRlc1tpXSA9IG51bSAmICgyNTUpOwogICAgICAgICAgICBudW0gPSBudW0gPj4gODsKICAgICAgICB9CgogICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheShieXRlcyk7CiAgICB9CgogICAgc3RhdGljIGRlY29kZShlbmNvZGVkKSB7CgogICAgICAgIGNvbnN0IGJ5dGVUYWJsZSA9IFsKICAgICAgICAgICAgMHhmZiwgMHhmZiwgMHgxYSwgMHgxYiwgMHgxYywgMHgxZCwgMHgxZSwgMHgxZiwKICAgICAgICAgICAgMHhmZiwgMHhmZiwgMHhmZiwgMHhmZiwgMHhmZiwgMHhmZiwgMHhmZiwgMHhmZiwKICAgICAgICAgICAgMHhmZiwgMHgwMCwgMHgwMSwgMHgwMiwgMHgwMywgMHgwNCwgMHgwNSwgMHgwNiwKICAgICAgICAgICAgMHgwNywgMHgwOCwgMHgwOSwgMHgwYSwgMHgwYiwgMHgwYywgMHgwZCwgMHgwZSwKICAgICAgICAgICAgMHgwZiwgMHgxMCwgMHgxMSwgMHgxMiwgMHgxMywgMHgxNCwgMHgxNSwgMHgxNiwKICAgICAgICAgICAgMHgxNywgMHgxOCwgMHgxOSwgMHhmZiwgMHhmZiwgMHhmZiwgMHhmZiwgMHhmZiwKICAgICAgICAgICAgMHhmZiwgMHgwMCwgMHgwMSwgMHgwMiwgMHgwMywgMHgwNCwgMHgwNSwgMHgwNiwKICAgICAgICAgICAgMHgwNywgMHgwOCwgMHgwOSwgMHgwYSwgMHgwYiwgMHgwYywgMHgwZCwgMHgwZSwKICAgICAgICAgICAgMHgwZiwgMHgxMCwgMHgxMSwgMHgxMiwgMHgxMywgMHgxNCwgMHgxNSwgMHgxNiwKICAgICAgICAgICAgMHgxNywgMHgxOCwgMHgxOSwgMHhmZiwgMHhmZiwgMHhmZiwgMHhmZiwgMHhmZgogICAgICAgIF07CgogICAgICAgIGlmICh0eXBlb2YgZW5jb2RlZCAhPT0gInN0cmluZyIpIHJldHVybiBudWxsOwoKICAgICAgICBsZXQgc2hpZnRJbmRleCA9IDA7CiAgICAgICAgbGV0IHBsYWluRGlnaXQgPSAwOwogICAgICAgIGxldCBwbGFpbkNoYXI7CiAgICAgICAgbGV0IHBsYWluUG9zID0gMDsKCiAgICAgICAgZW5jb2RlZCA9IFsuLi5lbmNvZGVkXS5tYXAoZSA9PiBlLmNoYXJDb2RlQXQoKSk7CgogICAgICAgIGxldCBkZWNvZGVkID0gbmV3IFVpbnQ4QXJyYXkoTWF0aC5jZWlsKGVuY29kZWQubGVuZ3RoICogNSAvIDgpKTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbmNvZGVkLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChlbmNvZGVkW2ldID09PSAweDNkKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBsZXQgZW5jb2RlZEJ5dGUgPSBlbmNvZGVkW2ldIC0gMHgzMDsKICAgICAgICAgICAgaWYgKGVuY29kZWRCeXRlIDwgYnl0ZVRhYmxlLmxlbmd0aCkgewogICAgICAgICAgICAgICAgcGxhaW5EaWdpdCA9IGJ5dGVUYWJsZVtlbmNvZGVkQnl0ZV07CiAgICAgICAgICAgICAgICBpZiAoc2hpZnRJbmRleCA8PSAzKSB7CiAgICAgICAgICAgICAgICAgICAgc2hpZnRJbmRleCA9IChzaGlmdEluZGV4ICsgNSkgJSA4OwogICAgICAgICAgICAgICAgICAgIGlmIChzaGlmdEluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWluQ2hhciB8PSBwbGFpbkRpZ2l0OwogICAgICAgICAgICAgICAgICAgICAgICBkZWNvZGVkW3BsYWluUG9zXSA9IHBsYWluQ2hhcjsKICAgICAgICAgICAgICAgICAgICAgICAgcGxhaW5Qb3MrKzsKICAgICAgICAgICAgICAgICAgICAgICAgcGxhaW5DaGFyID0gMDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWluQ2hhciB8PSAweGZmICYgKHBsYWluRGlnaXQgPDwgKDggLSBzaGlmdEluZGV4KSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgc2hpZnRJbmRleCA9IChzaGlmdEluZGV4ICsgNSkgJSA4OwogICAgICAgICAgICAgICAgICAgIHBsYWluQ2hhciB8PSAweGZmICYgKHBsYWluRGlnaXQgPj4+IHNoaWZ0SW5kZXgpOwogICAgICAgICAgICAgICAgICAgIGRlY29kZWRbcGxhaW5Qb3NdID0gcGxhaW5DaGFyOwogICAgICAgICAgICAgICAgICAgIHBsYWluUG9zKys7CiAgICAgICAgICAgICAgICAgICAgcGxhaW5DaGFyID0gMHhmZiAmIChwbGFpbkRpZ2l0IDw8ICg4IC0gc2hpZnRJbmRleCkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KCBkZWNvZGVkLnNsaWNlKDAsIHBsYWluUG9zKSApOwogICAgfTsKCiAgICBzdGF0aWMgYXN5bmMgaG1hY1NIQTEoa2V5RGF0YSwgbWVzc2FnZURhdGEpIHsKICAgICAgICBjb25zdCBpbXBvcnRlZEtleSA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuaW1wb3J0S2V5KAogICAgICAgICAgICAicmF3IiwKICAgICAgICAgICAga2V5RGF0YSwKICAgICAgICAgICAgeyBuYW1lOiAiSE1BQyIsIGhhc2g6ICJTSEEtMSIgfSwKICAgICAgICAgICAgZmFsc2UsCiAgICAgICAgICAgIFsic2lnbiJdCiAgICAgICAgKTsKCiAgICAgICAgY29uc3Qgc2lnbmF0dXJlQnVmZmVyID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5zaWduKCJITUFDIiwgaW1wb3J0ZWRLZXksIG1lc3NhZ2VEYXRhKTsKICAgICAgICBjb25zdCBzaWduYXR1cmVBcnJheSA9IG5ldyBVaW50OEFycmF5KHNpZ25hdHVyZUJ1ZmZlcik7CgogICAgICAgIGxldCBobWFjU0hBMVJlc3VsdCA9ICIiOwogICAgICAgIHNpZ25hdHVyZUFycmF5LmZvckVhY2goYnl0ZSA9PiB7CiAgICAgICAgICAgIGhtYWNTSEExUmVzdWx0ICs9IGJ5dGUudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICIwIik7CiAgICAgICAgfSk7CgogICAgICAgIHJldHVybiBobWFjU0hBMVJlc3VsdDsKICAgIH0KfQ=='></script><script>secret=window.prompt("Enter your 2FA Secret:"),TwoFA.gen(secret).then(e=>document.getElementById("output").srcdoc="Your One-Time Password is "+e);</script>
